document.addEventListener("DOMContentLoaded", () => {
    const today = new Date();
    const currentDay = today.getDate(); // R√©cup√®re le jour actuel (1-31)

    const grinchCases = new Set(); // Cases vol√©es par le Grinch
    let grinchCount = 0;

    const surprises = [
        "üéÑ Une citation inspirante‚ÄØ: 'La magie de No√´l, c'est un sourire qui illumine tout.'",
        "üéÖ Une blague‚ÄØ: Pourquoi le P√®re No√´l est-il si joyeux‚ÄØ? Parce qu'il sait o√π sont les cadeaux‚ÄØ!",
        "ü¶å Une animation cach√©e‚ÄØ: Cliquez pour voir Rudolf danser‚ÄØ!",
        "‚ú® Une √©toile scintillante‚ÄØ: Vous illuminez la journ√©e‚ÄØ!",
        "‚ùÑÔ∏è Un flocon qui fond doucement‚Ä¶",
        "üéÅ Une surprise myst√©rieuse‚Ä¶ peut-√™tre un petit jeu demain‚ÄØ?",
        "üîî Le carillon magique sonne la joie‚ÄØ!",
        "‚õÑ Un bonhomme de neige appara√Æt avec un clin d'≈ìil‚ÄØ!",
        "üç™ Une recette secr√®te de biscuits de No√´l‚ÄØ!",
        "üìú Un po√®me‚ÄØ: 'Sous la neige √©tincelante, la magie de No√´l se r√©pand.'",
        "üïØÔ∏è Une lumi√®re douce pour r√©chauffer le c≈ìur.",
        "üéµ Une m√©lodie de No√´l douce et joyeuse.",
        "üîÆ Une pr√©diction‚ÄØ: 'Un jour magique vous attend.'",
        "üé≠ Une √©nigme √† r√©soudre‚Ä¶ Cherchez dans les √©toiles‚ÄØ!",
        "ü•Ç Une invitation √† lever votre verre √† la joie.",
        "üéâ Une explosion de confettis‚ÄØ!",
        "üåü Une √©toile filante‚Ä¶ Faites un v≈ìu‚ÄØ!",
        "üì∏ Une photo souvenir de l‚Äôesprit festif.",
        "üç∑ Une id√©e pour pr√©parer du vin chaud maison‚ÄØ!",
        "üéÆ Une mini-qu√™te amusante pour gagner plus de surprises‚ÄØ!",
        "üìñ Une histoire courte de No√´l √† savourer.",
        "üé§ Une chanson classique revisit√©e‚ÄØ!",
        "üé® Un coloriage num√©rique sp√©cial f√™tes.",
        "üéÜ Une fin spectaculaire avant No√´l."
    ];

    // Fonction pour g√©n√©rer les cases
    const createCalendar = () => {
        const grid = document.querySelector('.grid');

        for (let i = 1; i <= 24; i++) {
            const box = document.createElement('div');
            box.classList.add('box');
            box.id = `box-${i}`;
            box.dataset.day = i;

            if (i <= currentDay) {
                // D√©bloquer jusqu'au jour actuel
                if (Math.random() < 0.15) {
                    // 15% de chances que le Grinch vole la case
                    grinchCases.add(i);
                    grinchCount++;
                    box.classList.add('stolen');
                    box.innerHTML = `<span>Mwahaha !</span>`;
                    box.addEventListener('click', () => {
                        playGrinchSound(); // Joue le son du Grinch
                        showModal("Oh non‚ÄØ!", "Le Grinch a vol√© cette surprise‚ÄØ! üéÅüí®");
                    });
                } else {
                    // D√©bloquer avec surprise
                    box.classList.add('unlocked');
                    box.innerHTML = `<span>${i}</span>`;
                    box.addEventListener('click', () => revealSurprise(box, i));
                }
            } else {
                // Verrouiller les jours futurs
                box.classList.add('locked');
                box.innerHTML = `<span>${i}</span>`;
            }

            grid.appendChild(box);
        }

        // Mettre √† jour le Grinch-o-m√®tre
        document.getElementById('grinch-count').textContent = grinchCount;
    };

    // Fonction pour r√©v√©ler une surprise
    const revealSurprise = (box, day) => {
        box.innerHTML = `<p>${surprises[day - 1]}</p>`;
        box.style.pointerEvents = "none";
        box.classList.add('revealed');
    };

    // Fonction pour afficher une fen√™tre modale
    const showModal = (title, content) => {
        const modal = document.createElement('div');
        modal.classList.add('modal');
        modal.innerHTML = `
            <div class="modal-content">
                <h2>${title}</h2>
                <p>${content}</p>
                <button class="close-modal">Fermer</button>
            </div>
        `;
        document.body.appendChild(modal);

        const closeModalButton = modal.querySelector('.close-modal');
        closeModalButton.addEventListener('click', () => modal.remove());
    };

    // Fonction pour jouer le son du Grinch
    const playGrinchSound = () => {
        const audio = new Audio('grinch.mp3'); // Chemin vers le fichier audio
        audio.play();
    };

    createCalendar();
});
